(this["webpackJsonpreact-drum-machine"]=this["webpackJsonpreact-drum-machine"]||[]).push([[0],{34:function(e,t,n){},47:function(e,t,n){"use strict";n.r(t);var i=n(9),c=n(8),r=n.n(c),o=n(15),s=n.n(o),l=(n(34),n(10)),u=n(19),a=["KICK","SNARE"],d=Object(c.createContext)(),j=d.Provider,f=function(e){var t=e.children,n=b();return Object(i.jsx)(j,{value:n,children:t})},h=function(){return Object(c.useContext)(d)},b=function(){var e=a.map((function(e){return{name:e,stepList:new Array(16).fill(0)}})),t=Object(u.a)(e),n=Object(l.a)(t,2),i=n[0],r=n[1],o=Object(c.useState)(0),s=Object(l.a)(o,2),d=s[0],j=s[1],f=Object(c.useState)(0),h=Object(l.a)(f,2);return{stepLists:i,updateStep:function(e,t,n){r((function(i){i[e].stepList[t]=n}))},currentStep:d,setCurrentStep:j,resetSteps:function(){r((function(){return e}))},selectInst:h[0],setSelectInst:h[1]}},x="#E2E4DF",p="#E06B2F",v="#14F396",O="#0a794b",m=function(e,t,n){return{width:"6.25%",height:"10px",boxShadow:"1px 1px 1px #9E9E9E",backgroundColor:t&&e>0?"#ffff00":t&&0===e?"#E06B2F":e>.9?O:e>0?v:"transparent"}},g=function(e){e.index;var t=e.velocity,n=e.isCurrent;return Object(i.jsx)("div",{style:m(t,n)})},w={position:"relative",width:"70vw",minWidth:"400px",maxWidth:"500px",backgroundColor:x},y={display:"flex",width:"100%",justifyContent:"center",alignItems:"center"},C=function(){var e=h(),t=e.stepLists,n=e.updateStep,c=e.currentStep;return Object(i.jsx)("div",{style:w,children:t.map((function(e,t){return Object(i.jsx)("div",{style:y,children:e.stepList.map((function(e,r){return Object(i.jsx)(g,{index:r,velocity:e,handleClick:function(i){n(t,r,e>0?0:.8)},handleDoubleClick:function(){n(t,r,1)},isCurrent:r===c},r)}))},t)}))})},k=n(11),S=function(e){var t=e.volumn,n=Object(c.useMemo)((function(){return(new k.c).toDestination()}),[]);return n.volume.value=t,{trigger:Object(c.useCallback)((function(e,t,i){n.triggerAttackRelease("C2",e,t,i)}),[])}},E=function(e){var t=e.volumn,n=Object(c.useMemo)((function(){return new k.b({frequency:11e3})}),[]),i=Object(c.useMemo)((function(){return new k.d({volume:-12,noise:{type:"pink",playbackRate:3},envelope:{attack:.001,decay:.13,sustain:0,release:.03}}).connect(n).toDestination()}),[]);return i.volume.value=t,{trigger:Object(c.useCallback)((function(e,t,n){i.triggerAttack(t,n)}),[])}},L=Object(c.createContext)(),I=L.Provider,V=function(e){var t=e.children,n=F();return Object(i.jsx)(I,{value:n,children:t})},D=function(){return Object(c.useContext)(L)},P=[{name:"DrumPad",hint:Object(i.jsxs)("p",{children:["Click: normal.",Object(i.jsx)("br",{})," Double Click: accentuation"]})},{name:"Mixer",hint:Object(i.jsx)("p",{children:"max:30 dB, min:-30dB"})}],F=function(){var e=Object(c.useState)(0),t=Object(l.a)(e,2),n=t[0],i=t[1],r=Object(c.useState)(1),o=Object(l.a)(r,2),s=(o[0],o[1],Object(u.a)(new Array(a.length).fill(0))),d=Object(l.a)(s,2),j=d[0],f=d[1];return{mainIdx:n,currViewName:P[n].name,currViewHint:P[n].hint,mainViewNext:function(){n+1<P.length&&i((function(e){return e+1}))},mainViewPrev:function(){n>0&&i((function(e){return e-1}))},hasNext:n+1<P.length,hasPrev:n>0,volumns:j,setVolumns:f}},M=function(e){var t=e.bpm,n=D().volumns;k.f.bpm.value=t;var i=h(),r=i.stepLists,o=i.setCurrentStep,s=S({volumn:n[0]}).trigger,a=E({volumn:n[1]}).trigger,d=Object(u.a)([]),j=Object(l.a)(d,2),f=j[0],b=j[1];return Object(c.useEffect)((function(){!function(){for(var e=function(){var e=Object(l.a)(n[t],2),i=e[0],c=void e[1];switch(f[i]&&k.f.clear(f[i]),i){case"0":c=k.f.schedule((function(e){r[i].stepList.forEach((function(t,n){t>0&&s("16n",e+n*k.e("16n").toSeconds(),t),k.a.schedule((function(){o(n)}),e+n*k.e("16n").toSeconds())}))}),"0");break;case"1":c=k.f.schedule((function(e){r[i].stepList.forEach((function(t,n){t&&a("16n",e+n*k.e("16n").toSeconds(),t)}))}),"0")}k.f.setLoopPoints(0,"1m"),k.f.loop=!0,b((function(e){e[i]=c}))},t=0,n=Object.entries(r);t<n.length;t++)e()}()}),[r]),{now:k.g()}},B=n(5),W=n(12),N={width:"30px",height:"30px",border:"none",borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",outline:"none",outlineOffset:"none"},R=function(e){var t=e.children,n=e.onClick,c=Object(W.a)(e,["children","onClick"]);return Object(i.jsx)("button",Object(B.a)(Object(B.a)({style:N,onClick:n},c),{},{children:t}))},A=n(28),T=n(22),H=(n(25),n.p+"static/media/play.1b4fe477.svg"),G=n.p+"static/media/stop.11946cce.svg",J=n.p+"static/media/reset.53fc7500.svg",K=n.p+"static/media/next.4a867727.svg",q=n.p+"static/media/prev.059d5327.svg",z={display:"flex",width:"70vw",height:"50px",minWidth:"400px",maxWidth:"500px",maxHeight:"50px",overflow:"scroll",backgroundColor:x},Y={width:"40px",height:"20px",backgroundColor:"transparent",border:"none",outline:"none",outlineOffset:"none"},Q={backgroundColor:"transparent"},U=[20,200],X=function(){var e=Object(c.useState)(90),t=Object(l.a)(e,2),n=t[0],r=t[1],o=Object(c.useState)(!1),s=Object(l.a)(o,2),u=(s[0],s[1],M({bpm:n}).now,h().resetSteps),a=D(),d=a.currViewName,j=a.currViewHint,f=a.mainViewNext,b=a.mainViewPrev,x=a.hasNext,p=a.hasPrev;return Object(c.useEffect)((function(){var e=function(e){"Space"===e.code&&(k.h(),k.f.toggle())};return window.addEventListener("keydown",e),function(){return window.removeEventListener("keydown",e)}})),Object(i.jsxs)("div",{style:z,children:[Object(i.jsx)(T.a,{overlay:Object(i.jsx)("input",{style:Y,placeholder:"BPM",type:"number",min:"1",onChange:function(e){var t=parseFloat(e.target.value);t>=U[0]&&t<=U[1]?r(parseFloat(e.target.value)):t<U[0]?r(U[0]):t>U[1]&&r(U[1])},value:n}),overlayInnerStyle:Q,placement:"bottom",children:Object(i.jsx)("div",{children:Object(i.jsx)(A.a,{hits:n,withBorder:!1,withGlow:!1,minLength:3,size:30,padding:4,digitSpacing:3,segmentThickness:3,segmentSpacing:.5,segmentActiveColor:"red",segmentInactiveColor:"#5c2e2e",backgroundColor:"#222222"})})}),Object(i.jsx)(R,{onClick:function(){k.h(),k.f.start()},children:Object(i.jsx)("img",{src:H,alt:"play",width:"15px"})}),Object(i.jsx)(R,{onClick:function(){k.f.pause()},children:Object(i.jsx)("img",{src:G,alt:"Stop",width:"15px"})}),Object(i.jsx)(R,{onClick:function(){u()},children:Object(i.jsx)("img",{src:J,alt:"Reset",width:"15px"})}),p&&Object(i.jsx)(R,{onClick:function(){b()},children:Object(i.jsx)("img",{src:q,alt:"prevView",width:"15px"})}),x&&Object(i.jsx)(R,{onClick:function(){f()},children:Object(i.jsx)("img",{src:K,alt:"nextView",width:"15px"})}),Object(i.jsx)(T.a,{overlay:j,placement:"bottom",children:Object(i.jsx)("div",{children:d})})]})},Z=function(e){var t=e.ref,n=e.latency,i=void 0===n?200:n,r=e.onSingleClick,o=void 0===r?function(){return null}:r,s=e.onDoubleClick,l=void 0===s?function(){return null}:s;Object(c.useEffect)((function(){var e=t.current,n=0,c=function(e){n+=1,setTimeout((function(){1===n?o(e):2===n&&l(e),n=0}),i)};return e.addEventListener("click",c),function(){e.removeEventListener("click",c)}}))},$=function(e){return{width:"24%",height:"24%",boxShadow:"1px 1px 1px #9E9E9E",flexShrink:"1",flexGrow:"1",backgroundColor:e>.9?O:e>0?v:"transparent"}},_=function(e){e.index;var t=e.velocity,n=e.handleClick,r=(e.isCurrent,e.handleDoubleClick),o=Object(c.useRef)();return Z({onSingleClick:n,onDoubleClick:r,ref:o,latency:250}),Object(i.jsx)("div",{ref:o,style:$(t)})},ee={width:"100px",height:"100%",borderLeft:"2px solid black"},te=function(e){return{height:"30px",boxShadow:"1px 1px 1px #9E9E9E",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",color:e?p:"black",fontWeight:e?900:400}},ne=function(){var e=h(),t=e.selectInst,n=e.setSelectInst;return Object(i.jsx)("div",{style:ee,children:a.map((function(e,c){return Object(i.jsx)(ie,{onClick:function(){n(c)},selected:t===c,children:e})}))})},ie=function(e){var t=e.children,n=e.selected,c=Object(W.a)(e,["children","selected"]);return Object(i.jsx)("div",Object(B.a)(Object(B.a)({style:te(n)},c),{},{children:t}))},ce={width:"100%",height:"100%",display:"flex"},re={width:"100%",height:"100%",display:"flex",flexWrap:"wrap"},oe=function(){var e=h(),t=e.stepLists,n=e.updateStep,c=(e.currentStep,e.selectInst);return Object(i.jsxs)("div",{style:ce,children:[Object(i.jsx)("div",{style:re,children:t[c].stepList.map((function(e,t){return Object(i.jsx)(_,{index:t,velocity:e,handleClick:function(i){n(c,t,e>0?0:.8)},handleDoubleClick:function(){n(c,t,1)}},t)}))}),Object(i.jsx)(ne,{})]})},se={width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"flex-end"},le={position:"relative",display:"flex",justifyContent:"center",alignItems:"flex-end",width:"10%",height:"100%",marginRight:"1%"},ue={position:"absolute",top:"50%"},ae=function(e){return{width:"100%",height:"".concat(fe(e),"%"),backgroundColor:p,display:"flex",justifyContent:"center",alignItems:"flex-end"}},de=function(){var e=D(),t=e.volumns,n=e.setVolumns;return Object(i.jsx)("div",{style:se,children:t.map((function(e,t){return Object(i.jsx)(je,{idx:t,vol:e,setVolumns:n})}))})},je=function(e){var t=e.idx,n=e.vol,r=e.setVolumns,o=Object(c.useState)(!1),s=Object(l.a)(o,2),u=s[0],d=s[1];return Object(i.jsx)("div",{onMouseEnter:function(){d(!0)},onMouseLeave:function(){d(!1)},style:le,onClick:function(e){var n=e.clientY-e.currentTarget.offsetTop;r((function(e){e[t]=he(n)}))},children:Object(i.jsxs)("div",{style:ae(n),children:[u&&Object(i.jsxs)("div",{style:ue,children:[a[t],Object(i.jsx)("br",{}),Math.round(10*n)/10,"dB"]}),u&&Object(i.jsx)("div",{style:ue,children:" "})]})})},fe=function(e){return 100*(e+30)/60},he=function(e){return 2*(450-e)/9*30/50-30},be={width:"70vw",height:"450px",minWidth:"400px",maxWidth:"500px",maxHeight:"450px",backgroundColor:x},xe=function(){var e=D().mainIdx;return Object(i.jsxs)("div",{style:be,children:[0===e&&Object(i.jsx)(oe,{}),1===e&&Object(i.jsx)(de,{})]})},pe={width:"800px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},ve=function(){return Object(i.jsxs)("div",{style:pe,children:[Object(i.jsx)("h1",{children:"Drum Machine"}),Object(i.jsxs)(f,{children:[Object(i.jsx)(C,{}),Object(i.jsxs)(V,{children:[Object(i.jsx)(xe,{}),Object(i.jsx)(X,{})]})]})]})},Oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,48)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),i(e),c(e),r(e),o(e)}))};s.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(ve,{})}),document.getElementById("root")),Oe()}},[[47,1,2]]]);